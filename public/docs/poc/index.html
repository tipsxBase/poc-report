<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Rspress v1.28.3">
  <title data-rh="true">POC  测试流程</title>
<script defer src="/docs/static/js/styles.a3598a48.js"></script><script defer src="/docs/static/js/lib-lodash.9f988a64.js"></script><script defer src="/docs/static/js/lib-react.c515e626.js"></script><script defer src="/docs/static/js/lib-router.f8437c4e.js"></script><script defer src="/docs/static/js/index.8d28cdc6.js"></script><link href="/docs/static/css/styles.a52ace92.css" rel="stylesheet"></head>

<body >
  <div id="root"><div><div class="navContainer_f6cde rspress-nav px-6 " style="position:sticky"><div class="container_f6cde flex justify-between items-center h-full"><div class="navBarTitle_f6cde"><a href="/docs/" class="flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><span></span></a></div><div class="flex flex-1 justify-end items-center"><div class="rightNav_f6cde"><div class="rspress-nav-menu menu h-14"><a class="link_03735  cursor-pointer" target="" href="/docs/poc/index.html"><div class="rspress-nav-menu-item singleItem_f6cde activeItem_f6cde text-sm font-medium mx-1.5 px-3 py-2 flex items-center">POC</div></a><a class="link_03735  cursor-pointer" target="" href="/docs/tpcc/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">TPC-C</div></a></div><div class="flex-center flex-row"></div></div><div class="mobileNavMenu_f6cde"><div class="navScreen_457e8 " id="navScreen"><div class="container_457e8"><div class="navMenu_457e8"><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/docs/poc/index.html"><div class="rspress-nav-menu-item singleItem_f6cde activeItem_f6cde text-sm font-medium mx-1.5 px-3 py-2 flex items-center">POC</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/docs/tpcc/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">TPC-C</div></a></div></div><div class="flex-center flex-col gap-2"></div></div></div><button aria-label="mobile hamburger" class=" navHamburger_e7b06 text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_edeb4 pt-0"><div class="rspress-sidebar-menu"><button class="flex-center mr-auto"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button><button class="flex-center ml-auto"><span class="text-sm">ON THIS PAGE</span><div class="text-md mr-2" style="transform:rotate(0deg);transition:transform 0.2s ease-out;margin-top:2px"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></button></div><aside class="sidebar_71eca rspress-sidebar "><div class="navTitleMask_71eca"><div class="navBarTitle_f6cde"><a href="/docs/" class="flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><span></span></a></div></div><div class="rspress-scrollbar sidebarContent_71eca"><nav class="pb-2"><a class="link_03735 menuLink_71eca cursor-pointer" target="" href="/docs/poc/index.html"><div class="menuItemActive_71eca mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>POC  测试流程</span></div></a></nav></div></aside><div class="content_edeb4 rspress-doc-container flex flex-shrink-0 mx-auto"><div class="w-full flex-1"><div><div class="rspress-doc"><!--$--><h1 id="poc-测试流程" class="text-3xl mb-10 leading-10 tracking-tight title_3b154">POC  测试流程<a class="link_3b154 header-anchor" aria-hidden="true" href="#poc-测试流程">#</a></h1>
<p class="my-4 leading-7"><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4BW12zvDODQ4/img/491e8940-98ea-4125-ad10-4d5a3c023c98.png" alt="POC流程图-第 2 页.drawio.png"/></p>
<h2 id="从零开始做-poc" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">从零开始做 POC<a class="link_3b154 header-anchor" aria-hidden="true" href="#从零开始做-poc">#</a></h2>
<h3 id="先对目标服务器进行磁盘性能测试及网络带宽测试此步骤也可在数据库安装完成后让运维同学进行测试" class="mt-10 mb-2 leading-7 text-xl title_3b154">先对目标服务器进行磁盘性能测试及网络带宽测试，此步骤也可在数据库安装完成后让运维同学进行测试<a class="link_3b154 header-anchor" aria-hidden="true" href="#先对目标服务器进行磁盘性能测试及网络带宽测试此步骤也可在数据库安装完成后让运维同学进行测试">#</a></h3>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fio --directory=/data/test --direct=1 --iodepth=32 --ioengine=libaio --bs=8k --size=4G --rw=randread --name=iops
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fio --directory=/data/test --direct=1 --iodepth=32 --ioengine=libaio --bs=8k --size=4G --rw=randwrite --name=iops
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fio --directory=/data/test --direct=1 --iodepth=32 --ioengine=libaio --bs=8k --size=4G --rw=write --name=iops</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>iperf3 -c 172.16.0.3 -b 1000M  -t  3  -d</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4BW12zvDODQ4/img/536f9f16-36b3-4bff-8136-e4ab7b1f0366.png" alt="image.png"/></p>
<p class="my-4 leading-7"><strong class="font-semibold">注：如果客户没有提供测试的服务或客户提供的测试服务器磁盘性能或网络性能测试效果不佳，可以引导客户使用我们的服务器进行测试，这样测试过程跟测试结果更加可控</strong>。</p>
<h3 id="参数调整" class="mt-10 mb-2 leading-7 text-xl title_3b154">参数调整<a class="link_3b154 header-anchor" aria-hidden="true" href="#参数调整">#</a></h3>
<p class="my-4 leading-7">在我们的知识库：<a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/gpG2NdyVXgxxOn3ZCXq63ekYWMwvDqPk?utm_scene=team_space" class="link_03735  link_3b154 inline-link_3b154">海纳参数调整</a>中有对应的调整参数的脚本：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3ert2ofqo5952fi" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《general_guc.sh》</a>是通用的参数调整脚本</li>
<li class="[&amp;:not(:first-child)]:mt-2"><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3h4mzi0oxzf8wnr8" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《oltp_guc.sh》</a>是  TP  场景的参数调整脚本</li>
<li class="[&amp;:not(:first-child)]:mt-2"><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3hwjf9bas7cxikct" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《olap_guc.sh》</a>是  AP  场景下的参数调整脚本</li>
</ul>
<p class="my-4 leading-7">如果测试的是  TP  场景，那么就将  general_guc.sh  跟  oltp_guc.sh  脚本执行一下，如果是  AP  场景就将 general_guc.sh  跟  olap_guc.sh  脚本执行一下。</p>
<div class="language-xml"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-xml" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>sh general_guc.sh
</span></span><span style="display:block;padding:0 1.25rem">sh oltp_guc.sh</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<div class="language-xml"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-xml" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>sh general_guc.sh
</span></span><span style="display:block;padding:0 1.25rem">sh olap_guc.sh</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="准备测试用例-yaml-文件" class="mt-10 mb-2 leading-7 text-xl title_3b154">准备测试用例 yaml 文件<a class="link_3b154 header-anchor" aria-hidden="true" href="#准备测试用例-yaml-文件">#</a></h3>
<p class="my-4 leading-7">根据客户的测试需求，从 POC 测试资产选择合适的测试用例，并按照测试要求将并发数、行宽及数据量进行调整。可以使用我们的工具进行测试用例管理</p>
<p class="my-4 leading-7"><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3mwy81o9lyno8wvg" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《POCMaster_0.2.2_aarch64.dmg》</a><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3mwy81o9lyno8wvg" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《POCMaster_0.2.2_x64_en-US.msi》</a><a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02lzw3mwy81o9lyno8wvg" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《POC 测试资产.docx》</a></p>
<p class="my-4 leading-7"><strong class="font-semibold">注：</strong></p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">如果资产库已有的用例已经有测试结果并且已经满足客户的测试需求的，大家可以跳过实际测试，直接拿测试结果。</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">如果客户没有特别具体的测试需求，那么我们可以按照客户的业务场景，比如  TP  还是  AP，然后从 POC 测试资产中选择适量用例形成测试报告。</strong></li>
</ol>
<h3 id="创建需要测试数据表" class="mt-10 mb-2 leading-7 text-xl title_3b154">创建需要测试数据表<a class="link_3b154 header-anchor" aria-hidden="true" href="#创建需要测试数据表">#</a></h3>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">连接数据库</li>
</ol>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ gsql -r -p 26700 -d postgres</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="2" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">创建用户，poc 测试时推荐创建用户时指标  sysadmin  角色，后面可以省去不少表没有权限的情况</li>
</ol>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>hexadb=# create user poc_train_row sysadmin password &#x27;hexadb@2024&#x27;;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="3" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">创建库</li>
</ol>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>hexadb=# CREATE DATABASE poc owner poc_admin_row ENCODING &#x27;UTF8&#x27; dbcompatibility = &#x27;PG&#x27;;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="4" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">使用新建的用户连接数据库</li>
</ol>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ gsql -d poc -U poc_admin_row -W poc@20240408 -p 26700 -r</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="5" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">创建 schema，推荐 schema  的名称跟用户名一样，这样在使用 jdbc 连接数据库的时候就可以不用指定  schema  名称，可以很容易的实现不同的用户连接不同的 schema。</li>
</ol>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>poc=&gt; create schema poc_admin_row;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="6" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">执行 DDL</li>
</ol>
<p class="my-4 leading-7">DDL 区分是  AP  还是  TP？</p>
<p class="my-4 leading-7">TP  场景则选择  <a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02m00qy57lk6fghf614n" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《ddl-row-oltp.sql》</a></p>
<p class="my-4 leading-7">AP  场景选择<a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/NkDwLng8ZePP3RLmsmqAZ4PrJKMEvZBY?doc_type=wiki_doc&amp;iframeQuery=anchorId%3DX02m00qyvxi7tyn8dp05xh" class="link_03735  link_3b154 inline-link_3b154">请至钉钉文档查看附件《ddl-column-olap.sql》</a></p>
<p class="my-4 leading-7">将 DDL 语句先上传至服务器中，通过命令创建数据表，也可以使用客户端工具比如  Navicat  或  DBeaver  等工具进行创建</p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># 连接数据库
</span></span><span style="display:block;padding:0 1.25rem">$ gsql -d poc -U poc_admin_row -W poc@20240408 -p 26700 -r
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"># 执行DDL语句
</span><span style="display:block;padding:0 1.25rem">\i /home/omm/poc/ddl.sql;</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="执行测试" class="mt-10 mb-2 leading-7 text-xl title_3b154">执行测试<a class="link_3b154 header-anchor" aria-hidden="true" href="#执行测试">#</a></h3>
<p class="my-4 leading-7">将测试用例及测试工具上传至测试服务器，启动测试工具进行测试</p>
<p class="my-4 leading-7">注：我们的测试工具依赖于 Java17，测试工具包中包括 JDK17 及测试工具包</p>
<div class="language-plaintext"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-plaintext" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>./jdk-17.0.10/bin/java -jar hexadb-poc.jar -config ./poc-cases/prepare_train.yml</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<div class="language-plaintext"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-plaintext" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>nohup ./jdk-17.0.10/bin/java -jar hexadb-poc.jar -config ./poc-cases/514_train.yml &gt; run.log 2&gt;&amp;1 &amp;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="生成形成报告" class="mt-10 mb-2 leading-7 text-xl title_3b154">生成形成报告<a class="link_3b154 header-anchor" aria-hidden="true" href="#生成形成报告">#</a></h3>
<p class="my-4 leading-7">按照我们提供的<a target="_blank" rel="noopener noreferrer" href="https://alidocs.dingtalk.com/i/nodes/mweZ92PV6zLLZ7M6C7j1MMyyVxEKBD6p?utm_scene=team_space" class="link_03735  link_3b154 inline-link_3b154">测试报告模板</a>，收集测试用例的执行结果生成测试报告</p>
<h2 id="poc-工具" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">POC  工具<a class="link_3b154 header-anchor" aria-hidden="true" href="#poc-工具">#</a></h2>
<h3 id="21-流行流程图" class="mt-10 mb-2 leading-7 text-xl title_3b154">2.1  流行流程图<a class="link_3b154 header-anchor" aria-hidden="true" href="#21-流行流程图">#</a></h3>
<p class="my-4 leading-7"><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4BW12zvDODQ4/img/a6ab405c-00a5-4d03-8cb6-e18dcd711c89.png" alt="POC流程图.png"/></p>
<h2 id="数据库常用命令" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">数据库常用命令<a class="link_3b154 header-anchor" aria-hidden="true" href="#数据库常用命令">#</a></h2>
<h3 id="21-命令行相关" class="mt-10 mb-2 leading-7 text-xl title_3b154">2.1  命令行相关<a class="link_3b154 header-anchor" aria-hidden="true" href="#21-命令行相关">#</a></h3>
<h4 id="211-查询集群状态" class="mt-8 leading-6 text-lg title_3b154">2.1.1  查询集群状态<a class="link_3b154 header-anchor" aria-hidden="true" href="#211-查询集群状态">#</a></h4>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ cm_ctl query -Cvipd</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<div class="language-plaintext"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-plaintext" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>[ CMServer State   ]
</span></span><span style="display:block;padding:0 1.25rem">node               node_ip         instance                                             state
</span><span style="display:block;padding:0 1.25rem">------------------------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">1 hexadb-master01 172.16.0.2     1   /data/hexadb_distributed/data/cmserver/cm_server Primary
</span><span style="display:block;padding:0 1.25rem">2 hexadb-master02 172.16.0.3     2   /data/hexadb_distributed/data/cmserver/cm_server Standby
</span><span style="display:block;padding:0 1.25rem">[   Cluster State   ]
</span><span style="display:block;padding:0 1.25rem">cluster_state   : Normal
</span><span style="display:block;padding:0 1.25rem">redistributing : No
</span><span style="display:block;padding:0 1.25rem">balanced       : No
</span><span style="display:block;padding:0 1.25rem">current_az     : AZ_ALL
</span><span style="display:block;padding:0 1.25rem">[ Coordinator State ]
</span><span style="display:block;padding:0 1.25rem">node               node_ip         instance                                             state
</span><span style="display:block;padding:0 1.25rem">-----------------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">1 hexadb-master01 172.16.0.2     5001 26700 /data/hexadb_distributed/data/coordinator Normal
</span><span style="display:block;padding:0 1.25rem">2 hexadb-master02 172.16.0.3     5002 26700 /data/hexadb_distributed/data/coordinator Normal
</span><span style="display:block;padding:0 1.25rem">[ Central Coordinator State ]
</span><span style="display:block;padding:0 1.25rem">node               node_ip         instance                                       state
</span><span style="display:block;padding:0 1.25rem">-----------------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">2 hexadb-master02 172.16.0.3     5002 /data/hexadb_distributed/data/coordinator Normal
</span><span style="display:block;padding:0 1.25rem">[     GTM State     ]
</span><span style="display:block;padding:0 1.25rem">node               node_ip         instance                               state                   sync_state
</span><span style="display:block;padding:0 1.25rem">-----------------------------------------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">2 hexadb-master02 172.16.0.3     1001 /data/hexadb_distributed/data/gtm P Standby Connection ok Sync
</span><span style="display:block;padding:0 1.25rem">3 hexadb-master03 172.16.0.4     1002 /data/hexadb_distributed/data/gtm S Primary Connection ok Sync
</span><span style="display:block;padding:0 1.25rem">[ Datanode State   ]
</span><span style="display:block;padding:0 1.25rem">node               node_ip         instance                                         state           | node               node_ip         instance                                         state           | node               node_ip         instance                                         state
</span><span style="display:block;padding:0 1.25rem">-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">1 hexadb-master01 172.16.0.2     6001 40001 /data/hexadb_distributed/data/master1 P Primary Normal | 2 hexadb-master02 172.16.0.3     6002 40001 /data/hexadb_distributed/data/slave1 S Standby Normal | 3 hexadb-master03 172.16.0.4     3002 /data/hexadb_distributed/data/dummy1 R Secondary Normal
</span><span style="display:block;padding:0 1.25rem">2 hexadb-master02 172.16.0.3     6003 40201 /data/hexadb_distributed/data/master2 P Standby Normal | 3 hexadb-master03 172.16.0.4     6004 40201 /data/hexadb_distributed/data/slave2 S Primary Normal | 1 hexadb-master01 172.16.0.2     3003 /data/hexadb_distributed/data/dummy2 R Secondary Normal
</span><span style="display:block;padding:0 1.25rem">3 hexadb-master03 172.16.0.4     6005 40401 /data/hexadb_distributed/data/master3 P Primary Normal | 1 hexadb-master01 172.16.0.2     6006 40401 /data/hexadb_distributed/data/slave3 S Standby Normal | 2 hexadb-master02 172.16.0.3     3004 /data/hexadb_distributed/data/dummy3 R Secondary Normal</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h4 id="212-重启集群" class="mt-8 leading-6 text-lg title_3b154">2.1.2  重启集群<a class="link_3b154 header-anchor" aria-hidden="true" href="#212-重启集群">#</a></h4>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ cm_ctl stop; cm_ctl start</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h4 id="213-使用-gs_guc-修改数据库参数" class="mt-8 leading-6 text-lg title_3b154">2.1.3  使用  gs_guc  修改数据库参数<a class="link_3b154 header-anchor" aria-hidden="true" href="#213-使用-gs_guc-修改数据库参数">#</a></h4>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ gs_guc set -I all -N all -c &quot;advance_xlog_file_num=16&quot; -c &quot;enable_thread_pool=off&quot; -Z datanode -Z coordinator</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">-N node</p>
</blockquote>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">-I instance</p>
</blockquote>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">-c  具体要设置的参数值</p>
</blockquote>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">设置指定 node 指定 instance 的参数</p>
</blockquote>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># 设置 hexadb-master01 节点上 dn_6001_6002 的参数
</span></span><span style="display:block;padding:0 1.25rem">$ gs_guc set -N hexadb-master01 -I dn_6001_6002 -c &quot;cstore_buffers=2GB&quot; -Z datanode</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">有的参数修改完是不需要重启集群的，有的参数修改完是需要重启集群的，参考  <a target="_blank" rel="noopener noreferrer" href="https://docs-opengauss.osinfra.cn/zh/docs/2.1.0/docs/Developerguide/GUC%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E.html" class="link_03735  link_3b154 inline-link_3b154">openGauss 官网</a>。</p>
<h3 id="22-数据库脚本" class="mt-10 mb-2 leading-7 text-xl title_3b154">2.2  数据库脚本<a class="link_3b154 header-anchor" aria-hidden="true" href="#22-数据库脚本">#</a></h3>
<h4 id="221-查询列存表的相关信息" class="mt-8 leading-6 text-lg title_3b154">2.2.1  查询列存表的相关信息<a class="link_3b154 header-anchor" aria-hidden="true" href="#221-查询列存表的相关信息">#</a></h4>
<p class="my-4 leading-7">列存表需要注意 cu 的信息，cu 太小的话会严重影响查询性能，查询 cu(文件单元的相关信息)，需要连接 DN 上执行</p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>-- 没有分区的表
</span></span><span style="display:block;padding:0 1.25rem">-- 查询oid
</span><span style="display:block;padding:0 1.25rem">select oid, * from pg_class where relname = &#x27;table_name&#x27;;
</span><span style="display:block;padding:0 1.25rem">-- 查询 cu信息
</span><span style="display:block;padding:0 1.25rem">select * from cstore.pg_cudesc_63893177 -- 63893177是oid的值;
</span><span style="display:block;padding:0 1.25rem">-- 带分区的表
</span><span style="display:block;padding:0 1.25rem">select oid, * from pg_class where relname = &#x27;poc_product&#x27;;
</span><span style="display:block;padding:0 1.25rem">select * from pg_partition where parentid = 63890951; -- 63890951是oid的值;
</span><span style="display:block;padding:0 1.25rem">select * from cstore.pg_cudesc_part_63890955; -- 63890955是relfilenode对应的列</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h4 id="222-其它数据库常用脚本" class="mt-8 leading-6 text-lg title_3b154">2.2.2  其它数据库常用脚本<a class="link_3b154 header-anchor" aria-hidden="true" href="#222-其它数据库常用脚本">#</a></h4>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>-- 查看当前schema
</span></span><span style="display:block;padding:0 1.25rem">show current_schmea;
</span><span style="display:block;padding:0 1.25rem">-- 修改schema
</span><span style="display:block;padding:0 1.25rem">set current_schema to new_schema;
</span><span style="display:block;padding:0 1.25rem">-- 查看所有schema
</span><span style="display:block;padding:0 1.25rem">\dn
</span><span style="display:block;padding:0 1.25rem">-- 执行sql 脚本
</span><span style="display:block;padding:0 1.25rem">\i /home/omm/ddl.sql;
</span><span style="display:block;padding:0 1.25rem">-- 查看所有数据表
</span><span style="display:block;padding:0 1.25rem">\d+
</span><span style="display:block;padding:0 1.25rem">-- 查看指定的数据表
</span><span style="display:block;padding:0 1.25rem">\d+ table_name
</span><span style="display:block;padding:0 1.25rem">-- 查看最大连接数
</span><span style="display:block;padding:0 1.25rem">SELECT setting FROM pg_settings WHERE name = &#x27;max_connections&#x27;;
</span><span style="display:block;padding:0 1.25rem">-- 查询数据库指定参数的配置
</span><span style="display:block;padding:0 1.25rem">show max_connections;
</span><span style="display:block;padding:0 1.25rem">-- 获取当前活跃连接数
</span><span style="display:block;padding:0 1.25rem">SELECT count(*) FROM pg_stat_activity;
</span><span style="display:block;padding:0 1.25rem">-- 查询当前正在执行的SQL
</span><span style="display:block;padding:0 1.25rem">select query  from pg_stat_activity where state = &#x27;active&#x27;;
</span><span style="display:block;padding:0 1.25rem">-- 查询数据的大致数据量
</span><span style="display:block;padding:0 1.25rem">analyze t_sim_cdr_apn_usage_p;
</span><span style="display:block;padding:0 1.25rem">select relname, reltuples from pg_class where relname like &#x27;table_name%&#x27;;
</span><span style="display:block;padding:0 1.25rem">-- 停止当前正在执行的SQL
</span><span style="display:block;padding:0 1.25rem">SELECT 
</span><span style="display:block;padding:0 1.25rem">pg_terminate_backend(pid)
</span><span style="display:block;padding:0 1.25rem">FROM pg_stat_activity
</span><span style="display:block;padding:0 1.25rem">WHERE pid &lt;&gt; pg_backend_pid() -- 排除当前会话
</span><span style="display:block;padding:0 1.25rem">AND state = &#x27;active&#x27; -- 只选择活动的会话
</span><span style="display:block;padding:0 1.25rem">AND query ILIKE &#x27;%YOUR_QUERY%&#x27;;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">select pg_terminate_backend(pid) from pg_stat_activity where pid &lt;&gt; pg_backend_pid() and state = &#x27;active&#x27; and query ilike &#x27;SELECT b.brand_name%&#x27;;</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h2 id="数据库参数设置及优化" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">数据库参数设置及优化<a class="link_3b154 header-anchor" aria-hidden="true" href="#数据库参数设置及优化">#</a></h2>
<h3 id="31-列式存储开启-delta-表" class="mt-10 mb-2 leading-7 text-xl title_3b154">3.1  列式存储开启 delta 表<a class="link_3b154 header-anchor" aria-hidden="true" href="#31-列式存储开启-delta-表">#</a></h3>
<p class="my-4 leading-7">列存表写入时建议开启 delta 表，如果不开启 delta 表直接写入列存表，会导致列存数据单元太小，这样不仅仅是磁盘性能占用很大，而且影响查询性能，开启 delta 后，会先将数据写入 delta 行存表，然后再自动存入列存表。</p>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ gs_guc reload -N all -I all -c &quot;enable_delta_store=on&quot; -Z coordinator -Z datanode</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="32-全文倒排索引gin-generalizedinvertedindex" class="mt-10 mb-2 leading-7 text-xl title_3b154">3.2  全文倒排索引( GIN-&gt; Generalized Inverted Index )<a class="link_3b154 header-anchor" aria-hidden="true" href="#32-全文倒排索引gin-generalizedinvertedindex">#</a></h3>
<p class="my-4 leading-7">创建 vs 插入</p>
<p class="my-4 leading-7">由于可能要为每个项目插入很多键，所以 GIN 索引的插入可能比较慢。对于向表中大量插入的操作，我们建议先删除 GIN 索引，在完成插入之后再重建索引。与 GIN 索引创建、查询性能相关的 GUC 参数如下：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">maintenance_work_mem</li>
</ul>
<p class="my-4 leading-7">GIN 索引的构建时间对 maintenance_work_mem 的设置非常敏感。</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">work_mem</li>
</ul>
<p class="my-4 leading-7">在向启用了 FASTUPDATE 的 GIN 索引执行插入操作的期间，只要待处理实体列表的大小超过了 work_mem，系统就会清理这个列表。为了避免可观察到的响应时间的大起大落，让待处理实体列表在后台被清理是比较合适的（比如通过 autovacuum）。前端清理操作可以通过增加 work_mem 或者执行 autovacuum 来避免。然而，扩大 work_mem 意味着如果发生了前端清理，那么他的执行时间将更长。</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">gin_fuzzy_search_limit</li>
</ul>
<p class="my-4 leading-7">开发 GIN 索引的主要目的是为了让 openGauss 支持高度可伸缩的全文索引，并且常常会遇见全文索引返回海量结果的情形。而且，这经常发生在查询高频词的时候，因而这样的结果集没什么用处。因为从磁盘读取大量记录并对其进行排序会消耗大量资源，这在产品环境下是不能接受的。为了控制这种情况，GIN 索引有一个可配置的返回结果行数的软上限的配置参数 gin_fuzzy_search_limit。缺省值 0 表示没有限制。如果设置了非零值，那么返回结果就是从完整结果集中随机选择的一部分。“软上限”的意思是返回结果的实际数量可能与指定的限制有偏差，这取决于查询和系统随机数生成器的质量。</p>
<h3 id="33-复制表" class="mt-10 mb-2 leading-7 text-xl title_3b154">3.3  复制表<a class="link_3b154 header-anchor" aria-hidden="true" href="#33-复制表">#</a></h3>
<p class="my-4 leading-7">不经常变化但需要经常关联小表（比如字典表）创建为复制表，复制表会在在各个 DN 上都存在，搜索时可以减少跨 DN 查找数据。</p>
<h3 id="34-数据库优化的参数" class="mt-10 mb-2 leading-7 text-xl title_3b154">3.4  数据库优化的参数<a class="link_3b154 header-anchor" aria-hidden="true" href="#34-数据库优化的参数">#</a></h3>
<h4 id="341work_mem" class="mt-8 leading-6 text-lg title_3b154">3.4.1 work_mem<a class="link_3b154 header-anchor" aria-hidden="true" href="#341work_mem">#</a></h4>
<p class="my-4 leading-7">设置内部排序操作和 Hash 表在开始写入临时磁盘文件之前使用的内存大小。ORDER BY、DISTINCT 和 merge joins 都要用到排序操作。Hash 表在散列连接、散列为基础的聚集、散列为基础的 IN 子查询处理中都要用到。</p>
<p class="my-4 leading-7">对于复杂的查询，可能会同时并发运行好几个排序或者散列操作，每个都可以使用此参数所声明的内存量，不足时会使用临时文件。同样，好几个正在运行的会话可能会同时进行排序操作。因此使用的总内存可能是 work_mem 的好几倍。</p>
<p class="my-4 leading-7"><strong class="font-semibold">设置命令：</strong></p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>gs_guc set -N all -I all -c &quot;work_mem=1GB&quot; -Z coordinator -Z datanode</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">设置建议：</strong></p>
<p class="my-4 leading-7">依据查询特点和并发来确定，一旦 work_mem 限定的物理内存不够，算子运算数据将写入临时表空间，带来 5-10 倍的性能下降，查询响应时间从秒级下降到分钟级。</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">对于串行无并发的复杂查询场景，平均每个查询有 5-10 关联操作，建议 work_mem=50%内存/10。</li>
<li class="[&amp;:not(:first-child)]:mt-2">对于串行无并发的简单查询场景，平均每个查询有 2-5 个关联操作，建议 work_mem=50%内存/5。</li>
<li class="[&amp;:not(:first-child)]:mt-2">对于并发场景，建议 work_mem=串行下的 work_mem/物理并发数</li>
</ul>
<h4 id="342max_process_memory" class="mt-8 leading-6 text-lg title_3b154">3.4.2 max_process_memory<a class="link_3b154 header-anchor" aria-hidden="true" href="#342max_process_memory">#</a></h4>
<p class="my-4 leading-7">设置一个数据库节点可用的最大物理内存。</p>
<p class="my-4 leading-7"><strong class="font-semibold">设置命令：</strong></p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>gs_guc set -N all -I all -c &quot;max_process_memory=4GB&quot; -Z datanode -Z coordinator</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">设置建议：</strong></p>
<p class="my-4 leading-7">数据库节点上该数值需要根据系统物理内存及单节点部署主数据库节点个数决定。建议计算公式如下：(物理内存大小  - vm.min_free_kbytes) \* 0.7 / (1 +  主节点个数)。该系数的目的是尽可能保证系统的可靠性，不会因数据库内存膨胀导致节点 OOM。这个公式中提到 vm.min_free_kbytes，其含义是预留操作系统内存供内核使用，通常用作操作系统内核中通信收发内存分配，至少为 5%内存。即，max_process_memory =  物理内存  * 0.665 / (1 +  主节点个数)。</p>
<p class="my-4 leading-7">2C3D  对应 CN 主节点个数为 2，DN 主节点个数为 3</p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7"><strong class="font-semibold">注意：</strong>  当该值设置不合理，即大于服务器物理内存，可能导致操作系统 OOM 问题。</p>
</blockquote>
<h4 id="343shared_buffers" class="mt-8 leading-6 text-lg title_3b154">3.4.3 shared_buffers<a class="link_3b154 header-anchor" aria-hidden="true" href="#343shared_buffers">#</a></h4>
<p class="my-4 leading-7">设置 HexaDB 使用的共享内存大小。增加此参数的值会使 HexaDB 比系统默认设置需要更多的 System V 共享内存。</p>
<p class="my-4 leading-7"><strong class="font-semibold">设置命令</strong></p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>gs_guc set -N all -I all -c &quot;shared_buffers=2GB&quot; -Z coordinator -Z datanode</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">设置建议：</strong></p>
<p class="my-4 leading-7">建议设置 shared_buffers 值为内存的 40%以内。行存列存分开对待。行存设大，列存设小。列存：(单服务器内存/单服务器数据库节点个数)*0.4*0.25。</p>
<p class="my-4 leading-7">如果设置较大的 shared_buffers 需要同时增加 checkpoint_segments 的值，因为写入大量新增、修改数据需要消耗更多的时间周期。</p>
<h4 id="344max_connections" class="mt-8 leading-6 text-lg title_3b154">3.4.4 max_connections<a class="link_3b154 header-anchor" aria-hidden="true" href="#344max_connections">#</a></h4>
<p class="my-4 leading-7">允许和数据库连接的最大并发连接数。此参数会影响 HexaDB 的并发能力。</p>
<p class="my-4 leading-7"><strong class="font-semibold">设置命令</strong></p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>gs_guc set -N all -I all -c &quot;max_connections=300&quot; -Z datanode -Z coordinator</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">设置建议：</strong></p>
<p class="my-4 leading-7">当高并发时提示数据库连接不够时，通过调整 max_connections 增加数据库连接</p>
<h4 id="345cstore_buffers" class="mt-8 leading-6 text-lg title_3b154">3.4.5 cstore_buffers<a class="link_3b154 header-anchor" aria-hidden="true" href="#345cstore_buffers">#</a></h4>
<p class="my-4 leading-7">设置列存所使用的共享缓冲区的大小。</p>
<p class="my-4 leading-7"><strong class="font-semibold">设置命令</strong></p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>gs_guc set -N all -I all -c &quot;cstore_buffers=2GB&quot; -Z datanode</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><strong class="font-semibold">设置建议：</strong></p>
<p class="my-4 leading-7">列存表使用 cstore_buffers 设置的共享缓冲区，几乎不用 shared_buffers。因此在列存表为主的场景中，应减少 shared_buffers，增加 cstore_buffers。</p>
<h2 id="faq" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">FAQ<a class="link_3b154 header-anchor" aria-hidden="true" href="#faq">#</a></h2>
<h3 id="41-当列存表开启-delta31通过-221-查询发现数据还在-delta-表没有真正写入列存表时要怎么办" class="mt-10 mb-2 leading-7 text-xl title_3b154">4.1  当列存表开启 delta（3.1）通过 2.2.1 查询发现数据还在 delta 表，没有真正写入列存表时，要怎么办？<a class="link_3b154 header-anchor" aria-hidden="true" href="#41-当列存表开启-delta31通过-221-查询发现数据还在-delta-表没有真正写入列存表时要怎么办">#</a></h3>
<p class="my-4 leading-7">可以手动从 delta 表 merge 到列存表</p>
<div class="language-postgresql"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-postgresql" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>vacuum deltamerge poc_product;</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="42-如果通过-cm_ctl-查询集群状态特别慢需要怎么办" class="mt-10 mb-2 leading-7 text-xl title_3b154">4.2  如果通过  cm_ctl  查询集群状态特别慢，需要怎么办？<a class="link_3b154 header-anchor" aria-hidden="true" href="#42-如果通过-cm_ctl-查询集群状态特别慢需要怎么办">#</a></h3>
<p class="my-4 leading-7">可以尝试杀掉  cm_server  进程</p>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ ps -ux | grep cm_server
</span></span><span style="display:block;padding:0 1.25rem">$ kill -9 id</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h2 id="其它命令" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_3b154">其它命令<a class="link_3b154 header-anchor" aria-hidden="true" href="#其它命令">#</a></h2>
<h3 id="查询磁盘io网络等适时指标" class="mt-10 mb-2 leading-7 text-xl title_3b154">查询磁盘、IO、网络等适时指标<a class="link_3b154 header-anchor" aria-hidden="true" href="#查询磁盘io网络等适时指标">#</a></h3>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># 每3秒打印一次
</span></span><span style="display:block;padding:0 1.25rem">sar -n DEV -urd 3</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="查询磁盘使用情况" class="mt-10 mb-2 leading-7 text-xl title_3b154">查询磁盘使用情况<a class="link_3b154 header-anchor" aria-hidden="true" href="#查询磁盘使用情况">#</a></h3>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>df -h</span></span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="海纳日志目录" class="mt-10 mb-2 leading-7 text-xl title_3b154">海纳日志目录<a class="link_3b154 header-anchor" aria-hidden="true" href="#海纳日志目录">#</a></h3>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>su - omm
</span></span><span style="display:block;padding:0 1.25rem">cd $GAUSSLOG/pg_log</span></code></pre></div><div class="code-button-group_15153"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div><!--/$--></div><div class="rspress-doc-footer"><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"></div><div class="flex flex-col"></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_e7091 flex flex-col"></div><div class="next_e7091 flex flex-col"></div></div></footer></div></div></div><div class="aside-container_edeb4"><div><div class="flex flex-col"><div class="&lt;lg:hidden"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">ON THIS PAGE</div><nav class="mt-1"><ul class="relative"><li><a href="#从零开始做-poc" title="从零开始做 POC" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">从零开始做 POC</span></a></li><li><a href="#先对目标服务器进行磁盘性能测试及网络带宽测试此步骤也可在数据库安装完成后让运维同学进行测试" title="先对目标服务器进行磁盘性能测试及网络带宽测试，此步骤也可在数据库安装完成后让运维同学进行测试" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">先对目标服务器进行磁盘性能测试及网络带宽测试，此步骤也可在数据库安装完成后让运维同学进行测试</span></a></li><li><a href="#参数调整" title="参数调整" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">参数调整</span></a></li><li><a href="#准备测试用例-yaml-文件" title="准备测试用例 yaml 文件" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">准备测试用例 yaml 文件</span></a></li><li><a href="#创建需要测试数据表" title="创建需要测试数据表" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">创建需要测试数据表</span></a></li><li><a href="#执行测试" title="执行测试" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">执行测试</span></a></li><li><a href="#生成形成报告" title="生成形成报告" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">生成形成报告</span></a></li><li><a href="#poc-工具" title="POC  工具" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">POC  工具</span></a></li><li><a href="#21-流行流程图" title="2.1  流行流程图" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">2.1  流行流程图</span></a></li><li><a href="#数据库常用命令" title="数据库常用命令" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">数据库常用命令</span></a></li><li><a href="#21-命令行相关" title="2.1  命令行相关" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">2.1  命令行相关</span></a></li><li><a href="#211-查询集群状态" title="2.1.1  查询集群状态" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">2.1.1  查询集群状态</span></a></li><li><a href="#212-重启集群" title="2.1.2  重启集群" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">2.1.2  重启集群</span></a></li><li><a href="#213-使用-gs_guc-修改数据库参数" title="2.1.3  使用  gs_guc  修改数据库参数" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">2.1.3  使用  gs_guc  修改数据库参数</span></a></li><li><a href="#22-数据库脚本" title="2.2  数据库脚本" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">2.2  数据库脚本</span></a></li><li><a href="#221-查询列存表的相关信息" title="2.2.1  查询列存表的相关信息" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">2.2.1  查询列存表的相关信息</span></a></li><li><a href="#222-其它数据库常用脚本" title="2.2.2  其它数据库常用脚本" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">2.2.2  其它数据库常用脚本</span></a></li><li><a href="#数据库参数设置及优化" title="数据库参数设置及优化" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">数据库参数设置及优化</span></a></li><li><a href="#31-列式存储开启-delta-表" title="3.1  列式存储开启 delta 表" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">3.1  列式存储开启 delta 表</span></a></li><li><a href="#32-全文倒排索引gin-generalizedinvertedindex" title="3.2  全文倒排索引( GIN-&gt; Generalized Inverted Index )" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">3.2  全文倒排索引( GIN-&gt; Generalized Inverted Index )</span></a></li><li><a href="#33-复制表" title="3.3  复制表" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">3.3  复制表</span></a></li><li><a href="#34-数据库优化的参数" title="3.4  数据库优化的参数" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">3.4  数据库优化的参数</span></a></li><li><a href="#341work_mem" title="3.4.1 work_mem" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">3.4.1 work_mem</span></a></li><li><a href="#342max_process_memory" title="3.4.2 max_process_memory" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">3.4.2 max_process_memory</span></a></li><li><a href="#343shared_buffers" title="3.4.3 shared_buffers" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">3.4.3 shared_buffers</span></a></li><li><a href="#344max_connections" title="3.4.4 max_connections" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">3.4.4 max_connections</span></a></li><li><a href="#345cstore_buffers" title="3.4.5 cstore_buffers" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:24px;font-weight:semibold"><span class="aside-link-text block">3.4.5 cstore_buffers</span></a></li><li><a href="#faq" title="FAQ" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">FAQ</span></a></li><li><a href="#41-当列存表开启-delta31通过-221-查询发现数据还在-delta-表没有真正写入列存表时要怎么办" title="4.1  当列存表开启 delta（3.1）通过 2.2.1 查询发现数据还在 delta 表，没有真正写入列存表时，要怎么办？" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">4.1  当列存表开启 delta（3.1）通过 2.2.1 查询发现数据还在 delta 表，没有真正写入列存表时，要怎么办？</span></a></li><li><a href="#42-如果通过-cm_ctl-查询集群状态特别慢需要怎么办" title="4.2  如果通过  cm_ctl  查询集群状态特别慢，需要怎么办？" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">4.2  如果通过  cm_ctl  查询集群状态特别慢，需要怎么办？</span></a></li><li><a href="#其它命令" title="其它命令" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">其它命令</span></a></li><li><a href="#查询磁盘io网络等适时指标" title="查询磁盘、IO、网络等适时指标" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">查询磁盘、IO、网络等适时指标</span></a></li><li><a href="#查询磁盘使用情况" title="查询磁盘使用情况" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">查询磁盘使用情况</span></a></li><li><a href="#海纳日志目录" title="海纳日志目录" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">海纳日志目录</span></a></li></ul></nav></div></div></div></div></div></div></div></section></div></div>
  <div id="search-container"></div>
</body>

</html>
